name: Release new version of addon to WoW Interface

on:
  workflow_dispatch:
    # Enables a button to manually run this against the main branch
  push:
    # Enables automatic deploys off pushes/merges into the main branch
    branches: [ main ]

jobs:
  get-deps:
    runs-on: ubuntu-latest
    steps:
      - name: Clone Processables Lib
        uses: robinraju/release-downloader@v1.4
        with:
          repository: "p3lim-wow/LibProcessable"
          latest: true
          zipBall: true
          out-file-path: "libs/LibProcessable"

      - name: Debugging
        run: |
          echo "ROOT"
          ls -la
          echo "CLONED REPO"
          ls -la libs

  release:
    uses: icbat/wow-addon-github-workflow/.github/workflows/release-wowi.yml@main
    with:
      addon_name: OpenThosePouches
      addon_bundled_files: OpenThosePouches.lua libs/ LICENSE README.md
      wowi_id: 26222
    secrets:
      wowi_api_token: ${{secrets.WOWI_API_TOKEN}}
