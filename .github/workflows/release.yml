name: Release new version of addon to WoW Interface

on:
  workflow_dispatch:
    # Enables a button to manually run this against the main branch
    branches: [ main ]
  push:
    # Enables automatic deploys off pushes/merges into the main branch
    branches: [ main ]

jobs:
  build:
    steps:
      - name: Clone Processables Lib
        uses: GuillaumeFalourd/clone-github-repo-action@v2
        with:
          owner: 'p3lim-wow'
          repository: 'LibProcessable'

      - name: Copy Processables into Lib
        run: |
          ls -lsa
          cp -r LibProcessable libs/
          ls -lsa
          ls libs -lsa

      - name: Upload to WoW Interface
        uses: icbat/wow-addon-github-workflow/.github/workflows/release-wowi.yml@main
        with:
          addon_name: OpenThosePouches
          addon_bundled_files: OpenThosePouches.lua libs/ LICENSE README.md
          wowi_id: 26222
        secrets:
          wowi_api_token: ${{secrets.WOWI_API_TOKEN}}
